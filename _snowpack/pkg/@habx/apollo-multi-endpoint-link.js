import{h,r as p,g as _,a as g}from"../common/index-8ed85517.js";import"../common/blockString-d58f1b60.js";import"../common/_commonjsHelpers-0597c316.js";var m=function(){var s=function(r,i){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])},s(r,i)};return function(r,i){s(r,i);function t(){this.constructor=r}r.prototype=i===null?Object.create(i):(t.prototype=i.prototype,new t)}}(),v=function(s,r,i){var t,n,o,l,e,a;return(a=(e=(l=(o=(n=(t=s.query.definitions.find(function(c){return c.kind==="OperationDefinition"}))===null||t===void 0?void 0:t.directives)===null||n===void 0?void 0:n.find(function(c){var u;return((u=c.name)===null||u===void 0?void 0:u.value)===r}))===null||o===void 0?void 0:o.arguments)===null||l===void 0?void 0:l.find(function(c){var u;return((u=c.name)===null||u===void 0?void 0:u.value)===i}))===null||e===void 0?void 0:e.value)===null||a===void 0?void 0:a.value},k=function(s){m(r,s);function r(i,t){var n=s.call(this,t)||this;return n.config=i,n.httpLink=i.createHttpLink(),n.wsLinks={},n}return r.prototype.request=function(i,t){var n,o,l;if(!h(["api"],i.query))return(n=t==null?void 0:t(i))!==null&&n!==void 0?n:null;var e=v(i,"api","name");if(!e){var a=v(i,"api","contextKey");a&&(e=i.getContext()[a])}var c=p([{name:"api",remove:!0}],i.query);if(!c)throw new Error("Error while removing directive api");i.query=c,this.config.getContext&&i.setContext(this.config.getContext(e,i.getContext)),this.config.endpoints[e]&&i.setContext({uri:""+this.config.endpoints[e]+((o=this.config.httpSuffix)!==null&&o!==void 0?o:"/graphql")});var u=_(i.query);if(u.kind==="OperationDefinition"&&u.operation==="subscription"){if(!this.config.createWsLink)throw new Error('You tried to call a subscription without configuring "createWsLink" function:'+i.query);if(!this.wsLinks[e]){var f=this.config.endpoints[e],d=f.startsWith("/")?(""+window.location.origin+f).replace("http","ws"):f.replace("http","ws");this.wsLinks[e]=this.config.createWsLink(""+d+((l=this.config.wsSuffix)!==null&&l!==void 0?l:"/graphql/subscriptions"))}return this.wsLinks[e].request(i,t)}return this.httpLink.request(i,t)},r}(g);export{k as MultiAPILink};
